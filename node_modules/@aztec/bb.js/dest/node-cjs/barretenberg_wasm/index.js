"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BarretenbergWasm = void 0;
const tslib_1 = require("tslib");
const comlink_1 = require("comlink");
const debug_1 = tslib_1.__importDefault(require("debug"));
const index_js_1 = require("./barretenberg_wasm_main/factory/node/index.js");
const index_js_2 = require("./helpers/node/index.js");
const index_js_3 = require("./barretenberg_wasm_main/index.js");
const debug = (0, debug_1.default)('bb.js:wasm');
class BarretenbergWasm extends index_js_3.BarretenbergWasmMain {
    /**
     * Construct and initialize BarretenbergWasm within a Worker. Return both the worker and the wasm proxy.
     * Used when running in the browser, because we can't block the main thread.
     */
    static async new(threads) {
        const worker = (0, index_js_1.createMainWorker)();
        const wasm = (0, index_js_2.getRemoteBarretenbergWasm)(worker);
        await wasm.init(threads, (0, comlink_1.proxy)(debug));
        return { worker, wasm };
    }
}
exports.BarretenbergWasm = BarretenbergWasm;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvYmFycmV0ZW5iZXJnX3dhc20vaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHFDQUFnQztBQUNoQywwREFBZ0M7QUFDaEMsNkVBQWtGO0FBQ2xGLHNEQUFvRTtBQUNwRSxnRUFBcUc7QUFFckcsTUFBTSxLQUFLLEdBQUcsSUFBQSxlQUFXLEVBQUMsWUFBWSxDQUFDLENBQUM7QUFFeEMsTUFBYSxnQkFBaUIsU0FBUSwrQkFBb0I7SUFDeEQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBZ0I7UUFDdEMsTUFBTSxNQUFNLEdBQUcsSUFBQSwyQkFBZ0IsR0FBRSxDQUFDO1FBQ2xDLE1BQU0sSUFBSSxHQUFHLElBQUEsb0NBQXlCLEVBQTZCLE1BQU0sQ0FBQyxDQUFDO1FBQzNFLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBQSxlQUFLLEVBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUN2QyxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxDQUFDO0lBQzFCLENBQUM7Q0FDRjtBQVhELDRDQVdDIn0=