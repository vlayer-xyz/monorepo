import * as fs from 'fs';
export * from './timer.js';
const bfd = (() => {
    const bfdStr = process.env.BENCHMARK_FD;
    const bfd = bfdStr ? parseInt(bfdStr) : -1;
    if (bfd >= 0 && !fs.fstatSync(bfd)) {
        throw new Error('fd is not open. Did you redirect in your shell?');
    }
    return bfd;
})();
export function writeBenchmark(name, value, labels = {}) {
    if (bfd === -1) {
        return;
    }
    const data = {
        timestamp: new Date().toISOString(),
        name,
        type: typeof value,
        value,
        ...labels,
    };
    const jsonl = JSON.stringify(data) + '\n';
    fs.writeSync(bfd, jsonl);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvYmVuY2htYXJrL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxFQUFFLE1BQU0sSUFBSSxDQUFDO0FBQ3pCLGNBQWMsWUFBWSxDQUFDO0FBRTNCLE1BQU0sR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFO0lBQ2hCLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDO0lBQ3hDLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMzQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ2xDLE1BQU0sSUFBSSxLQUFLLENBQUMsaURBQWlELENBQUMsQ0FBQztLQUNwRTtJQUNELE9BQU8sR0FBRyxDQUFDO0FBQ2IsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUVMLE1BQU0sVUFBVSxjQUFjLENBQUksSUFBWSxFQUFFLEtBQVEsRUFBRSxTQUE4QixFQUFFO0lBQ3hGLElBQUksR0FBRyxLQUFLLENBQUMsQ0FBQyxFQUFFO1FBQ2QsT0FBTztLQUNSO0lBQ0QsTUFBTSxJQUFJLEdBQUc7UUFDWCxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7UUFDbkMsSUFBSTtRQUNKLElBQUksRUFBRSxPQUFPLEtBQUs7UUFDbEIsS0FBSztRQUNMLEdBQUcsTUFBTTtLQUNWLENBQUM7SUFDRixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQztJQUMxQyxFQUFFLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUMzQixDQUFDIn0=